<!--suppress JSAnnotator -->

<template>
  <div id="app">

    <!-- Status bar overlay for fullscreen mode-->
    <div class="statusbar"></div>

    <div class="view view-main" >
    </div>

  </div>
</template>

<style>



</style>

<script>

  import { ContainerService } from "../../service/core/container-service"

  import { UiService } from "../../service/core/ui-service"

  import { WalletService } from "../../service/core/wallet-service"

  export default (props, { $on, $f7ready, $f7, $f7router, $update }) => {


    
    $f7ready(async () => {
  
      let getHash = () => {
        return window.location.hash?.length > 2 ? window.location.hash.substring(2) : undefined
      }

      let baseURI = window.location.pathname
      let hash = getHash()

      // console.log(baseURI)
      // console.log(hash)

      let uiService = ContainerService.getInstance(UiService)
      let walletService = ContainerService.getWalletService()
      let schemaService = ContainerService.getInstance(SchemaService)

      // if (typeof window !== "undefined" && window['ethereum']) {

      //   await init()

      //   //Listen for changes
      //   window['ethereum'].on('accountsChanged', async (accounts) => {

      //     if (accounts?.length > 0) {

      //       await walletService.initWallet()
      //       let walletAddress = await walletService.getAddress()
      //       await schemaService.loadWallet(walletAddress)

      //       uiService.showSpinner("Loading...")
      //       mainView.router.navigate(getHash() ? getHash() : '/', { 
      //         reloadAll: true, 
      //         reloadCurrent: true, 
      //         clearPreviousHistory: true,
      //         ignoreCache: true
      //       })
      //       uiService.hideSpinner()

      //       // await init()
      //     }
      //   })

      // }

      await initNoWallet()
 


      async function initNoWallet() {

        uiService.showSpinner("Loading...")

        $f7.views.create('.view-main', {
          url: hash ? hash : '/',
          browserHistory: true,
          browserHistoryRoot: baseURI,
          reloadCurrent: true,
        })

        uiService.hideSpinner()

      }


    })


    return $render
  }

</script>